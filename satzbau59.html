<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satzbau-Baukasten: Russische Adjektive im Dativ</title>
    <script src="https://cdn.jsdelivr.net/npm/drag-drop-touch@1.3.1/DragDropTouch.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #27ae60;
            --error: #e74c3c;
            --bg: #f0f2f5;
            --card: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background-color: var(--bg);
            color: var(--primary);
            margin: 0;
            padding: 10px;
            display: flex;
            justify-content: center;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: var(--card);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        header {
            text-align: center;
            border-bottom: 3px solid var(--secondary);
            margin-bottom: 25px;
            padding-bottom: 10px;
        }

        .instruction {
            background: #eef2f7;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 5px solid var(--secondary);
        }

        .exercise-card {
            border: 2px solid #eaeeef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            background: #fff;
        }

        .task-label {
            font-weight: bold;
            color: var(--secondary);
            margin-bottom: 10px;
            display: block;
        }

        /* Satz-Bereich */
        .sentence-area {
            min-height: 50px;
            border: 2px dashed #bdc3c7;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            transition: all 0.3s;
        }

        .sentence-area.correct { background-color: #d4edda; border-color: var(--success); }
        .sentence-area.incorrect { background-color: #f8d7da; border-color: var(--error); }

        /* Wort-Pool */
        .word-pool {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }

        .word-chip {
            padding: 8px 14px;
            background: var(--primary);
            color: white;
            border-radius: 20px;
            cursor: pointer;
            user-select: none;
            font-size: 0.95rem;
            transition: transform 0.1s, opacity 0.2s;
        }

        .word-chip:hover { transform: scale(1.05); }
        .word-chip.used { opacity: 0.2; pointer-events: none; }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.85rem;
            transition: background 0.2s;
        }

        .btn-reset { background: #95a5a6; color: white; }
        .btn-sol { background: var(--secondary); color: white; }
        button:hover { filter: brightness(0.9); }

        @media (max-width: 600px) {
            .container { padding: 15px; }
            .word-chip { font-size: 0.85rem; padding: 6px 10px; }
            .btn-group { flex-direction: column; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Russisch-Assistent</h1>
        <h2>Baukasten: Sätze im Dativ</h2>
    </header>

    <div class="instruction">
        <strong>Anleitung:</strong> Bringe die Wörter in die richtige Reihenfolge.
        <br>1. Klicke auf die <strong>dunklen Wörter</strong>, um sie in den Satz einzubauen.
        <br>2. Klicke auf ein Wort im <strong>Satz-Feld</strong>, um es wieder zu entfernen.
    </div>

    <div id="exercise-list"></div>
</div>

<script>
    const exercises = [
        { id: 1, words: ["Катя", "помогает", "молодому", "человеку"] },
        { id: 2, words: ["Мы", "идём", "к", "новому", "дому"] },
        { id: 3, words: ["Она", "звонит", "лучшей", "подруге"] },
        { id: 4, words: ["Мама", "рада", "хорошей", "погоде"] },
        { id: 5, words: ["Я", "подошёл", "к", "большому", "окну"] },
        { id: 6, words: ["Учитель", "помогает", "умному", "ученику"] },
        { id: 7, words: ["Они", "едут", "к", "старому", "дедушке"] },
        { id: 8, words: ["Мы", "пишем", "любимой", "бабушке"] },
        { id: 9, words: ["Помоги", "этому", "бедному", "ребёнку"] },
        { id: 10, words: ["Она", "идёт", "к", "синей", "больнице"] },
        { id: 11, words: ["Я", "рад", "летнему", "солнцу"] },
        { id: 12, words: ["Собака", "бежит", "к", "маленькому", "мальчику"] },
        { id: 13, words: ["Передай", "привет", "новой", "учительнице"] },
        { id: 14, words: ["Мы", "подошли", "к", "красивому", "озеру"] },
        { id: 15, words: ["Он", "звонит", "дальнему", "родственнику"] },
        { id: 16, words: ["Иди", "к", "соседнему", "зданию"] },
        { id: 17, words: ["Дети", "рады", "первому", "снегу"] },
        { id: 18, words: ["Позвони", "своему", "младшему", "брату"] },
        { id: 19, words: ["Скорая", "едет", "к", "соседней", "аптеке"] },
        { id: 20, words: ["Мы", "рады", "прекрасной", "погоде"] }
    ];

    let userStates = {};

    function shuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    function renderExercises() {
        const list = document.getElementById('exercise-list');
        list.innerHTML = '';
        
        exercises.forEach((ex) => {
            userStates[ex.id] = [];
            const card = document.createElement('div');
            card.className = 'exercise-card';
            card.id = `card-${ex.id}`;

            const poolWords = shuffle([...ex.words]);

            card.innerHTML = `
                <span class="task-label">Aufgabe ${ex.id}</span>
                <div class="sentence-area" id="area-${ex.id}"></div>
                <div class="word-pool" id="pool-${ex.id}">
                    ${poolWords.map((w, idx) => `<span class="word-chip" id="chip-${ex.id}-${idx}" onclick="addWord(${ex.id}, '${w}', ${idx})">${w}</span>`).join('')}
                </div>
                <div class="btn-group">
                    <button class="btn-reset" onclick="resetTask(${ex.id})">Zurücksetzen & mischen</button>
                    <button class="btn-sol" onclick="showSolution(${ex.id})">Lösung anzeigen</button>
                </div>
            `;
            list.appendChild(card);
        });
    }

    window.addWord = (id, word, chipIdx) => {
        const chip = document.getElementById(`chip-${id}-${chipIdx}`);
        if (chip.classList.contains('used')) return;

        chip.classList.add('used');
        userStates[id].push({ word, chipIdx });
        updateSentence(id);
    };

    window.removeWord = (id, stateIdx) => {
        const removed = userStates[id].splice(stateIdx, 1)[0];
        const chip = document.getElementById(`chip-${id}-${removed.chipIdx}`);
        chip.classList.remove('used');
        updateSentence(id);
    };

    function updateSentence(id) {
        const area = document.getElementById(`area-${id}`);
        const state = userStates[id];
        const target = exercises.find(e => e.id === id).words;

        area.innerHTML = state.map((item, idx) => 
            `<span class="word-chip" onclick="removeWord(${id}, ${idx})">${item.word}</span>`
        ).join('');

        // Feedback
        area.classList.remove('correct', 'incorrect');
        if (state.length === target.length) {
            const currentSentence = state.map(i => i.word).join(' ');
            const targetSentence = target.join(' ');
            if (currentSentence === targetSentence) {
                area.classList.add('correct');
            } else {
                area.classList.add('incorrect');
            }
        }
    }

    window.resetTask = (id) => {
        userStates[id] = [];
        const ex = exercises.find(e => e.id === id);
        const pool = document.getElementById(`pool-${id}`);
        const area = document.getElementById(`area-${id}`);
        
        area.className = 'sentence-area';
        area.innerHTML = '';
        
        const shuffled = shuffle([...ex.words]);
        pool.innerHTML = shuffled.map((w, idx) => 
            `<span class="word-chip" id="chip-${id}-${idx}" onclick="addWord(${id}, '${w}', ${idx})">${w}</span>`
        ).join('');
    };

    window.showSolution = (id) => {
        const ex = exercises.find(e => e.id === id);
        const area = document.getElementById(`area-${id}`);
        const pool = document.getElementById(`pool-${id}`);
        
        // Mark chips as used
        const chips = pool.querySelectorAll('.word-chip');
        chips.forEach(c => c.classList.add('used'));

        // Rebuild correct order
        userStates[id] = ex.words.map((word, idx) => ({ word, chipIdx: -1 }));
        
        area.innerHTML = ex.words.map(w => `<span class="word-chip" style="cursor:default">${w}</span>`).join('');
        area.className = 'sentence-area correct';
    };

    window.onload = renderExercises;
</script>

</body>
</html>